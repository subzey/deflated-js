(()=>{"use strict";var e={m:{},u:e=>"crunch-worker.js",o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),p:"./"};e.b=document.baseURI||self.location.href;let t=null,r=!1;document.querySelector("#load-jquery").addEventListener("click",(async e=>{e.preventDefault();const t=await fetch("https://code.jquery.com/jquery-3.6.0.min.js");if(!t.ok)throw new Error(`Not ok: ${t.status}`);const r=await t.text(),n=document.querySelector("#input");""===n.value&&(n.value=r)})),document.querySelector("#paste").addEventListener("click",(async e=>{e.preventDefault();const t=await navigator.clipboard.readText(),r=document.querySelector("#input");""===r.value&&(r.value=t)})),document.querySelector("form").addEventListener("submit",(async n=>{n.preventDefault();const o=document.querySelector("#output-section output");o.textContent="Crunching...";try{const n=await(a=function(){let e=document.querySelector("#input").value;if(e=e.replace(/^[\s;]+/,"").replace(/[\s;]+$/,""),""===e)throw new Error("Please type or paste something");const t=document.querySelector("#template").value.trim()||void 0,r=document.querySelector("#iterations").value.trim();let n;if(""!==r&&(n=Math.ceil(Number(r)),!Number.isFinite(n)||n<=0))throw new RangeError("The number of iterations should be a positive integer");return{source:e,template:t,iterations:n}}(),new Promise(((n,o)=>{t&&!r&&(t.terminate(),t=null),null===t&&(t=new Worker(new URL(e.p+e.u(231),e.b),{name:"Crunch worker"})),r=!1;const c=t;c.onerror=e=>{c===t&&o(e)},c.onmessageerror=()=>{c===t&&o(new Error("messageerror"))},c.onmessage=e=>{c===t&&(e.data.result?(r=!0,n(e.data.result)):o(new Error(e.data.errorMessage??"Unknown error")))},c.postMessage(a)}))),c=new Date,u=new Blob([n],{type:"text/html;charset=utf-8"}),s=URL.createObjectURL(u),l=document.createElement("a");l.target="_blank",l.textContent="Preview",l.href=s;const i=document.createElement("button");i.type="button",i.textContent="Download",i.addEventListener("click",(e=>{e.preventDefault();const t=document.createElement("a");t.href=s;const r=["crunch",`${c.getFullYear()}-${String(c.getMonth()+1).padStart(2,"0")}-${String(c.getDate()).padStart(2,"0")}`,`${String(c.getHours()).padStart(2,"0")}-${String(c.getMinutes()).padStart(2,"0")}-${String(c.getSeconds()).padStart(2,"0")}`].join("_");t.download=`${r}.html`,t.click()})),o.textContent=`${n.byteLength} bytes. `,o.appendChild(l),o.appendChild(document.createTextNode(" ")),o.appendChild(i)}catch(n){o.textContent="";const e=n.message||"",t=document.createElement("span");t.classList.add("error"),t.textContent="❌ "+e,o.appendChild(t)}var a}));for(const e of Array.from(document.querySelectorAll("input, textarea")))e.addEventListener("focus",(()=>{for(const e of Array.from(document.querySelectorAll("#output-section output .error")))e.classList.add("obsolete")}))})();